using TMPro;
using UnityEngine;

public abstract class Malware : MonoBehaviour
{
    public string Decode;

    public int s_elseif_min;
    public int s_elseif_max;

    [Range(0f, 1f)]
    public float s_else_chance = 0f;

    public float TimeTillDestroy;

    public readonly string s_if = "if(){}";
    public readonly string s_elseif = "else if(){}";
    public readonly string s_else = "else(){}";

    public TextMeshProUGUI DecodeText;

    [SerializeField]
    public EMalwareType Type { get; protected set; }

    protected virtual void BuildCode()
    {
        Decode = s_if;

        int elifc = Random.Range(s_elseif_min, s_elseif_max);
        for(int i = 0; i < elifc; i++)
        {
            Decode += s_elseif;
        }

        float chance = Random.Range(0f, 1f);
        if(s_else_chance <= chance)
        {
            Decode += s_else;
        }
    }

    private void OnEnable()
    {
        BuildCode();
        DecodeText.text = Decode;
    }

    public abstract void Skill();
}
